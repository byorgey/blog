<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>blog :: Brent -> [String] - Identifying outdated packages in cabal install plans</title>
        <!-- <link rel="stylesheet" type="text/css" href="/css/default.css" /> -->
        <link rel="stylesheet" type="text/css" href="../../../../css/syntax.css" />
        <link rel="stylesheet" type="text/css" href="../../../../css/tufte.css" />

        <!-- See https://katex.org/docs/browser -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
        <link rel="alternate" type="application/rss+xml" href="../../../../rss.xml" title="RSS Feed">

        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>

        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

    </head>
    <body>
        <div id="header">
            <div id="navigation">
                <a href="../../../../">Home</a> •
                <a href="../../../../about.html">About</a> •
                <a href="../../../../rss.xml">RSS</a> •
                <a href="../../../../posts/blogliterately.html">BlogLiterately</a> •
                <a href="../../../../posts/catsters-guide-2.html">Catsters Guide</a> •
                <a href="../../../../posts/how-to-print-things.html">How To Print Things</a>
            </div>
        </div>

        <article>
          
<a href="../../../../posts/2012/08/24/unordered-tuples-and-type-algebra.html">« Unordered tuples and type algebra</a>


<span style="margin-left: 2em">

<a href="../../../../posts/2012/08/26/blogliterately-0-5-2-release-with-improved-image-uploading.html">» BlogLiterately 0.5.2 release, with improved image uploading</a>

</span>


<h1>Identifying outdated packages in cabal install plans</h1>

<div class="info">
  Posted on August 25, 2012
  
  
  <br />
  Tagged <a title="All pages tagged 'cabal'." href="../../../../tag/cabal.html" rel="tag">cabal</a>, <a title="All pages tagged 'development'." href="../../../../tag/development.html" rel="tag">development</a>, <a title="All pages tagged 'highlight'." href="../../../../tag/highlight.html" rel="tag">highlight</a>, <a title="All pages tagged 'install'." href="../../../../tag/install.html" rel="tag">install</a>, <a title="All pages tagged 'plan'." href="../../../../tag/plan.html" rel="tag">plan</a>, <a title="All pages tagged 'versions'." href="../../../../tag/versions.html" rel="tag">versions</a>
  
</div>

<section>
<p>
Every time I build a Haskell package—whether using <code>cabal</code> or <code>cabal-dev</code>, whether something from Hackage or a development version of my own package—I always do a <code>–dry-run</code> first, and inspect the install plan to make sure it looks reasonable. I’m sure I’m not the only person who does this (in fact, if you <em>don’t</em> do this, perhaps you should).
</p>
<p>
But what is meant by "reasonable"? Really, what I look for are versions of packages being installed which are <em>not</em> the latest versions available on Hackage. Sometimes this is fine, if the package I am installing, or one of its dependencies, legitimately can’t use the most cutting-edge version of some package. But sometimes it indicates a problem—the upper bound on some dependency needs to be updated. (Note that I’m <em>not</em> trying to get into the upper bounds vs. no upper bounds debate here; just stating facts.)
</p>
<p>
To help automate this process, I threw together a little tool that I’ve just uploaded to Hackage: <a href="http://hackage.haskell.org/package/highlight%2Dversions">highlight-versions</a>. If you take an install plan generated by <code>–dry-run</code> (or any output containing package identifiers like <code>foo-0.3.2</code>) and pipe it through <code>highlight-versions</code>, it will highlight any packages that don’t correspond to the latest version on Hackage.
</p>
<p>
For example, suppose running <code>cabal-dev install –dry-run</code> generates the following output:
</p>
<pre><code>$ cabal-dev install --dry-run
Resolving dependencies...
In order, the following would be installed (use -v for more details):
Boolean-0.0.1
NumInstances-1.0
colour-2.3.3
dlist-0.5
data-default-0.5.0
glib-0.12.3.1
newtype-0.2
semigroups-0.8.4
split-0.1.4.3
transformers-0.2.2.0
cmdargs-0.9.7
comonad-3.0.0.2
contravariant-0.2.0.2
mtl-2.0.1.0
cairo-0.12.3.1
gio-0.12.3
pango-0.12.3
gtk-0.12.3.1
semigroupoids-3.0
void-0.5.7
MemoTrie-0.5
vector-space-0.8.2
active-0.1.0.2
vector-space-points-0.1.1.1
diagrams-core-0.5.0.1
diagrams-lib-0.5.0.1
diagrams-cairo-0.5.1</code></pre>
<p>
This is a big wall of text, and nothing is obvious just from staring at it. But piping the output through <code>highlight-versions</code> gives us some helpful information:
</p>
<pre><code>$ cabal-dev install --dry-run | highlight-versions
Resolving dependencies...
In order, the following would be installed (use -v for more details):
Boolean-0.0.1
NumInstances-1.0
colour-2.3.3
dlist-0.5
data-default-0.5.0
glib-0.12.3.1
newtype-0.2
semigroups-0.8.4
<span style="color:red;">split-0.1.4.3</span> (<span style="color:blue;">0.2.0.0</span>)
<span style="color:red;">transformers-0.2.2.0</span> (<span style="color:blue;">0.3.0.0</span>)
<span style="color:red;">cmdargs-0.9.7</span> (<span style="color:blue;">0.10</span>)
comonad-3.0.0.2
contravariant-0.2.0.2
<span style="color:red;">mtl-2.0.1.0</span> (<span style="color:blue;">2.1.2</span>)
cairo-0.12.3.1
gio-0.12.3
pango-0.12.3
gtk-0.12.3.1
semigroupoids-3.0
void-0.5.7
MemoTrie-0.5
vector-space-0.8.2
active-0.1.0.2
vector-space-points-0.1.1.1
diagrams-core-0.5.0.1
diagrams-lib-0.5.0.1
<span style="color:cyan;">diagrams-cairo-0.5.1</span> (<span style="color:blue;">0.5.0.2</span>)</code></pre>
<p>
We can immediately see that there are newer versions of the <code>split</code>, <code>transformers</code>, <code>cmdargs</code>, and <code>mtl</code> packages (and precisely what those newer versions are). We can also see that the version of <code>diagrams-cairo</code> to be installed is newer than the version on Hackage (since this is a development version). These aren’t necessarily problems in and of themselves, but in my experience, if you don’t know <em>why</em> <code>cabal</code> or <code>cabal-dev</code> have chosen outdated versions of some packages, it’s probably worth investigating. (<code>–dry-run -v3</code> can help here.) This is also useful when uploading new versions of packages, to make sure they work with the latest and greatest stuff on Hackage. In this case the problems are just because of some changes I made to the <code>.cabal</code> file for the purposes of this blog post, making some upper bounds too restrictive, but in general it could be due to other dependencies as well.
</p>

</section>

<script data-isso="http://155.138.238.211" src="http://155.138.238.211/js/embed.min.js"></script>
<section id="isso-thread"></section>


        </article>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
