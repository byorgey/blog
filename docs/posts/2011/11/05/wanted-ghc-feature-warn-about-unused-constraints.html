<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>blog :: Brent -> [String] - Wanted GHC feature: warn about unused constraints</title>
        <!-- <link rel="stylesheet" type="text/css" href="/css/default.css" /> -->
        <link rel="stylesheet" type="text/css" href="../../../../css/syntax.css" />
        <link rel="stylesheet" type="text/css" href="../../../../css/tufte.css" />

        <!-- See https://katex.org/docs/browser -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">

        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>

        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

    </head>
    <body>
        <div id="header">
            <div id="navigation">
                <a href="../../../../">Home</a> •
                <a href="../../../../about.html">About</a>
            </div>
        </div>

        <article>
          
<a href="../../../../posts/2011/10/24/more-counting-lambda-terms.html">« More counting lambda terms</a>


<span style="margin-left: 2em">

<a href="../../../../posts/2011/11/12/generating-plane-tilings-with-diagrams.html">» Generating plane tilings with diagrams</a>

</span>


<h1>Wanted GHC feature: warn about unused constraints</h1>

<div class="info">
  Posted on November  6, 2011
  
  
  <br />
  Tagged <a title="All pages tagged 'constraints'." href="../../../../tag/constraints.html" rel="tag">constraints</a>, <a title="All pages tagged 'GHC'." href="../../../../tag/GHC.html" rel="tag">GHC</a>, <a title="All pages tagged 'unused'." href="../../../../tag/unused.html" rel="tag">unused</a>, <a title="All pages tagged 'warning'." href="../../../../tag/warning.html" rel="tag">warning</a>
  
</div>

<section>
<p>Consider the following function:</p>
<code>
<pre>
foo :: (Show a, Ord a) =&gt; a -&gt; a -&gt; String
foo x y = show x ++ show y
</pre>
<p></code></p>
<p>Currently (as of GHC 7.2.1) when compiling this code with <code>-Wall</code>, no warnings are generated. But I’d really love to get a warning like</p>
<code>
<pre>
Foo.hs:1:1: Warning: Unused constraint: Ord a
</pre>
<p></code></p>
<p>I see no theoretical impediments here. At the level of fully desugared and elaborated GHC core, it is no harder to tell which constraints are unused than which arguments are unused, because constraints <i>are</i> arguments.</p>
<p>One possible objection is that there is some inherent ambiguity here. For example, consider:</p>
<code>
<pre>
bar :: (Eq a, Ord a) =&gt; a -&gt; a -&gt; String
bar x y | x == y    = "yay"
        | otherwise = "boo"
</pre>
<p></code></p>
<p>When elaborating <code>bar</code>, GHC has a free choice of where to get the needed <code>(==)</code> method: from the <code>Eq</code> constraint or from the <code>Eq</code> superclass of the <code>Ord</code> constraint. So we might get a warning about <code>Eq</code> being redundant or about <code>Ord</code> being redundant, depending on which one it decides to use. But I don’t see this as a big problem.</p>
<p>I think this could make for a nice project for someone wanting to dig into hacking on GHC. Perhaps I’ll do it myself at some point if no one else takes it on.</p>

</section>

<script data-isso="http://155.138.238.211" src="http://155.138.238.211/js/embed.min.js"></script>
<section id="isso-thread"></section>


        </article>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
